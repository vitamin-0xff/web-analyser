# Rules for detecting frontend technologies

- name: WordPress
  category: CMS
  evidence:
    - type: html_pattern
      pattern: |
        <meta\s+name=["']generator["']\s+content=["'][^"']*wordpress[^"']*["']>
      confidence: 0.9
    - type: html_comment
      pattern: 'WordPress|Theme Name:|Theme URI:'
      confidence: 0.7

- name: Jekyll
  category: Static Site Generator
  evidence:
    - type: html_comment
      pattern: |
        <!--\s*generated\s+by\s+jekyll\s*-->
      confidence: 1.0

- name: React
  category: Frontend Framework
  evidence:
    - type: html_pattern
      pattern: |
        <div\s+id=["'](?:react-)?root["']>
      confidence: 0.3 # Weak signal alone
    - type: js_comment
      pattern: '@license React|React version'
      confidence: 0.6

- name: Vue.js
  category: Frontend Framework
  evidence:
    - type: html_pattern
      pattern: id=["']app["']
      confidence: 0.3
    - type: html_pattern
      pattern: 'data-v-app'
      confidence: 0.9
    - type: js_comment
      pattern: 'Vue\.js v[0-9]+|@vue/'
      confidence: 0.7

- name: Svelte
  category: Frontend Framework
  evidence:
    - type: html_pattern
      pattern: 'data-svelte'
      confidence: 0.9

- name: jQuery
  category: JavaScript Library
  evidence:
    - type: script_src
      pattern: 'jquery.*\.js'
      confidence: 0.9

# Extended frontend detections

- name: Next.js
  category: Frontend Framework
  evidence:
    - type: html_pattern
      pattern: |
        <div\s+id=["']__next["']>
      confidence: 0.8

- name: Angular
  category: Frontend Framework
  evidence:
    - type: html_pattern
      pattern: |
        <\w+\s+[^>]*ng-version=["'][^"']+["']
      confidence: 0.8

- name: Hugo
  category: Static Site Generator
  evidence:
    - type: html_pattern
      pattern: |
        <meta\s+name=["']generator["']\s+content=["'][^"']*hugo[^"']*["']>
      confidence: 0.9

- name: Squarespace
  category: CMS
  evidence:
    - type: html_pattern
      pattern: |
        <meta\s+name=["']generator["']\s+content=["'][^"']*squarespace[^"']*["']>
      confidence: 0.9

- name: Shopify
  category: Ecommerce
  evidence:
    - type: html_pattern
      pattern: |
        <meta\s+name=["']generator["']\s+content=["'][^"']*shopify[^"']*["']>
      confidence: 0.9

- name: Drupal
  category: CMS
  evidence:
    - type: html_pattern
      pattern: |
        <meta\s+name=["']generator["']\s+content=["'][^"']*drupal[^"']*["']>
      confidence: 0.9
    - type: html_pattern
      pattern: 'Drupal\.settings|drupalSettings'
      confidence: 0.8

- name: Joomla
  category: CMS
  evidence:
    - type: html_pattern
      pattern: |
        <meta\s+name=["']generator["']\s+content=["'][^"']*joomla[^"']*["']>
      confidence: 0.9
    - type: html_pattern
      pattern: '/media/jui/js/'
      confidence: 0.7

- name: Wix
  category: CMS
  evidence:
    - type: html_pattern
      pattern: 'wix\.com|wixstatic\.com'
      confidence: 0.9

- name: Webflow
  category: CMS
  evidence:
    - type: html_pattern
      pattern: 'webflow\.com|webflow\.io'
      confidence: 0.9

- name: Ghost
  category: CMS
  evidence:
    - type: html_pattern
      pattern: |
        <meta\s+name=["']generator["']\s+content=["'][^"']*ghost[^"']*["']>
      confidence: 0.9

- name: Gatsby
  category: Static Site Generator
  evidence:
    - type: html_pattern
      pattern: 'gatsby|___gatsby'
      confidence: 0.8
    - type: html_pattern
      pattern: |
        <div\s+id=["']___gatsby["']>
      confidence: 0.9

- name: Nuxt.js
  category: Frontend Framework
  evidence:
    - type: html_pattern
      pattern: |
        <div\s+id=["']__nuxt["']>
      confidence: 0.9
    - type: html_pattern
      pattern: 'data-n-head'
      confidence: 0.8

- name: Astro
  category: Static Site Generator
  evidence:
    - type: html_pattern
      pattern: 'astro-'
      confidence: 0.7

- name: Remix
  category: Frontend Framework
  evidence:
    - type: html_pattern
      pattern: 'remix'
      confidence: 0.6

- name: SolidJS
  category: Frontend Framework
  evidence:
    - type: html_pattern
      pattern: 'data-solid'
      confidence: 0.8

- name: Preact
  category: Frontend Framework
  evidence:
    - type: html_pattern
      pattern: 'preact'
      confidence: 0.6

- name: Eleventy
  category: Static Site Generator
  evidence:
    - type: html_pattern
      pattern: |
        <meta\s+name=["']generator["']\s+content=["'][^"']*eleventy[^"']*["']>
      confidence: 0.9

- name: Hexo
  category: Static Site Generator
  evidence:
    - type: html_pattern
      pattern: |
        <meta\s+name=["']generator["']\s+content=["'][^"']*hexo[^"']*["']>
      confidence: 0.9

- name: Pelican
  category: Static Site Generator
  evidence:
    - type: html_pattern
      pattern: |
        <meta\s+name=["']generator["']\s+content=["'][^"']*pelican[^"']*["']>
      confidence: 0.9

- name: Magento
  category: Ecommerce
  evidence:
    - type: html_pattern
      pattern: 'Mage\.Cookies|mage/cookies'
      confidence: 0.8

- name: PrestaShop
  category: Ecommerce
  evidence:
    - type: html_pattern
      pattern: 'prestashop'
      confidence: 0.7

- name: WooCommerce
  category: Ecommerce
  evidence:
    - type: html_pattern
      pattern: 'woocommerce'
      confidence: 0.8

- name: BigCommerce
  category: Ecommerce
  evidence:
    - type: html_pattern
      pattern: 'bigcommerce'
      confidence: 0.8

- name: OpenCart
  category: Ecommerce
  evidence:
    - type: html_pattern
      pattern: 'route=|catalog/view/'
      confidence: 0.5

- name: Contentful
  category: Headless CMS
  evidence:
    - type: html_pattern
      pattern: 'contentful'
      confidence: 0.7

- name: Strapi
  category: Headless CMS
  evidence:
    - type: html_pattern
      pattern: 'strapi'
      confidence: 0.7
