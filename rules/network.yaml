# Rules for detecting technologies via network information (TLS, DNS)

- name: Let's Encrypt
  category: Certificate Authority
  evidence:
    - type: tls_issuer
      name: "commonName"
      pattern: "let's encrypt"
      confidence: 0.9

- name: Cloudflare
  category: CDN
  evidence:
    - type: tls_issuer
      name: "organizationName"
      pattern: "cloudflare"
      confidence: 0.9
    - type: dns_record
      name: "CNAME"
      pattern: "cloudflare.net"
      confidence: 0.8

- name: Amazon Web Services
  category: IaaS
  evidence:
    - type: dns_record
      name: "CNAME"
      pattern: "amazonaws.com"
      confidence: 0.8

- name: Microsoft Azure
  category: IaaS
  evidence:
    - type: dns_record
      name: "CNAME"
      pattern: "azurewebsites.net|cloudapp.net"
      confidence: 0.8

- name: Google Search Console
  category: SEO
  evidence:
    - type: dns_record
      name: "TXT"
      pattern: "google-site-verification"
      confidence: 0.7

# Extended network/CDN/CA detections

- name: Akamai
  category: CDN
  evidence:
    - type: dns_record
      name: "CNAME"
      pattern: 'akamaihd\.net|edgekey\.net|edgesuite\.net'
      confidence: 0.8

- name: Fastly
  category: CDN
  evidence:
    - type: dns_record
      name: "CNAME"
      pattern: 'fastly\.net'
      confidence: 0.8

- name: Amazon CloudFront
  category: CDN
  evidence:
    - type: dns_record
      name: "CNAME"
      pattern: 'cloudfront\.net'
      confidence: 0.8

- name: Netlify
  category: Hosting
  evidence:
    - type: dns_record
      name: "CNAME"
      pattern: 'netlify\.app'
      confidence: 0.7

- name: Vercel
  category: Hosting
  evidence:
    - type: dns_record
      name: "CNAME"
      pattern: 'vercel\.app'
      confidence: 0.7

- name: DigiCert
  category: Certificate Authority
  evidence:
    - type: tls_issuer
      name: "organizationName"
      pattern: "DigiCert"
      confidence: 0.9

- name: Sectigo
  category: Certificate Authority
  evidence:
    - type: tls_issuer
      name: "organizationName"
      pattern: "Sectigo|COMODO"
      confidence: 0.9

- name: SPF Record Present
  category: Email
  evidence:
    - type: dns_record
      name: "TXT"
      pattern: "v=spf1"
      confidence: 0.6

# Email Security Extensions

- name: DMARC Policy
  category: Email Security
  evidence:
    - type: dns_record
      name: "TXT"
      pattern: 'v=DMARC1'
      confidence: 0.6

- name: DKIM Signing
  category: Email Security
  evidence:
    - type: dns_record
      name: "TXT"
      pattern: 'v=DKIM1'
      confidence: 0.6

- name: MTA-STS
  category: Email Security
  evidence:
    - type: dns_record
      name: "TXT"
      pattern: 'v=STSv1'
      confidence: 0.6

# Email Service Providers

- name: Mailgun
  category: Email
  evidence:
    - type: dns_record
      name: "CNAME"
      pattern: 'mailgun\.org'
      confidence: 0.8

- name: SendGrid
  category: Email
  evidence:
    - type: dns_record
      name: "CNAME"
      pattern: 'sendgrid'
      confidence: 0.8

- name: Mailchimp
  category: Email
  evidence:
    - type: dns_record
      name: "CNAME"
      pattern: 'mailchimp'
      confidence: 0.7
