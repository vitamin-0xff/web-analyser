# Rules for detecting JavaScript technologies

- name: React
  category: Frontend Framework
  evidence:
    - type: script_src
      pattern: 'react(\.min)?\.js'
      confidence: 0.7
    - type: js_global
      pattern: '__REACT_DEVTOOLS_GLOBAL_HOOK__|React'
      confidence: 0.9

- name: Angular
  category: Frontend Framework
  evidence:
    - type: script_src
      pattern: 'angular(\.min)?\.js'
      confidence: 0.7
    - type: js_global
      pattern: 'angular'
      confidence: 0.9

- name: Vue.js
  category: Frontend Framework
  evidence:
    - type: script_src
      pattern: 'vue(\.min)?\.js'
      confidence: 0.7
    - type: js_global
      pattern: 'Vue'
      confidence: 0.9

- name: jQuery
  category: JavaScript Library
  evidence:
    - type: js_global
      pattern: 'jQuery|\$'
      confidence: 0.9
    - type: script_src
      pattern: 'jquery.*\.js'
      confidence: 0.9

- name: Lodash
  category: JavaScript Library
  evidence:
    - type: js_global
      pattern: '_'
      confidence: 0.7 # Can be generic
    - type: script_src
      pattern: 'lodash.*\.js'
      confidence: 0.9

- name: Moment.js
  category: JavaScript Library
  evidence:
    - type: js_global
      pattern: 'moment'
      confidence: 0.9
    - type: script_src
      pattern: 'moment.*\.js'
      confidence: 0.9

# Extended JavaScript detections

- name: Google Tag Manager
  category: Analytics
  evidence:
    - type: script_src
      pattern: 'gtm\.js|/gtm\.js'
      confidence: 0.8
    - type: js_global
      pattern: 'dataLayer'
      confidence: 0.7

- name: Google Analytics
  category: Analytics
  evidence:
    - type: script_src
      pattern: 'analytics\.js|gtag/js'
      confidence: 0.8
    - type: js_global
      pattern: 'gtag|ga'
      confidence: 0.7

- name: Alpine.js
  category: JavaScript Library
  evidence:
    - type: script_src
      pattern: 'alpine(\.min)?\.js'
      confidence: 0.8
    - type: js_global
      pattern: 'Alpine'
      confidence: 0.8

- name: Preact
  category: Frontend Framework
  evidence:
    - type: script_src
      pattern: 'preact(\.min)?\.js'
      confidence: 0.7
    - type: js_global
      pattern: 'preact|Preact'
      confidence: 0.8

- name: D3.js
  category: JavaScript Library
  evidence:
    - type: script_src
      pattern: 'd3(\.min)?\.js'
      confidence: 0.8
    - type: js_global
      pattern: 'd3'
      confidence: 0.9

- name: Three.js
  category: JavaScript Library
  evidence:
    - type: script_src
      pattern: 'three(\.min)?\.js'
      confidence: 0.8
    - type: js_global
      pattern: 'THREE'
      confidence: 0.9

- name: GSAP
  category: JavaScript Library
  evidence:
    - type: script_src
      pattern: 'gsap(\.min)?\.js'
      confidence: 0.8
    - type: js_global
      pattern: 'gsap'
      confidence: 0.9

- name: Stripe.js
  category: Payments
  evidence:
    - type: script_src
      pattern: 'js\.stripe\.com'
      confidence: 0.9
    - type: js_global
      pattern: 'Stripe'
      confidence: 0.9
